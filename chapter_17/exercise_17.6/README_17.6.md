# Упражнение по программированию 17.6  
Рассмотрите определение класса, предложенное в упражнении 5 главы 14. Если вы  
ещё не делали это упражнение, выполните его сейчас. Затем сделайте следующее.  
  
  Напишите программу, которая использует стандартный ввод-вывод С++ и файловый  
  ввод-вывод в сочетании с данными типов `employee`, `manager`, `fink` и  
  `highfink`, как определено в упражнении 5 из главы 14. Программа должна быть  
  аналогична главным строкам листинга 17.17 в том, что должна позволять вносить  
  новые данные в файл. При первом запуске программа должна запросить данные у  
  пользователя, показать все введённые записи и сохранить информацию в файл.  
  При последующих запусках она должна сначала прочитать и отобразить данные  
  файла, дать возможность пользователю добавить новые данные и отобразить все  
  данные снова. Единственное отличие должно состоять в том, что данные должны  
  быть представлены в виде массива указателей на тип `employee`, либо на объект  
  любого из трёх производных от него типов. Сохраняйте массив маленьким, чтобы  
  облегчить его проверку программой; например, его размер можно ограничить 10  
  элементами:
  ```cpp
    const int MAX = 10;   // не более 10 объектов
    ...
    employee* pc[MAX];
  ```
  Для клавиатурного ввода программа должна использовать меню, чтобы  
  предоставить пользователю выбор типа создаваемого объекта. С меню должен  
  быть связан оператор `switch()`, позволяющий использовать операцию `new` для  
  создания объекта требуемого типа и присваивать адрес этого объекта указателю  
  в массиве `pc`. Затем этот объект может вызвать виртуалльную функцию `setall()`  
  для запроса соответствующих данных от пользователя:  
```cpp
  pc[i]->setall();    // вызывает функцию, соответствующую типу объекта
```
Чтобы обеспечить сохранение данных в файле, необходимо объявить виртуальную  
функцию `writeall()`:  
```cpp
  for (i = 0; i < index; i++)
    pc[i]->writeall(fout);    // объект fout типа ostream  
                              // подключен к выходному файлу
```
Сложность представляет воостановление данных из файла. Проблема состоит в том,  
как программа узнает, какого типа объект будет восстановлен следующим:  
`employee`, `manager`, `fink` либо `highfink`? Один из возможных подходов  
к решению этой проблемы заключается в следующем: при записи данных объекта в  
файл предварить его целым числом, идентифицирующим тип следующего объекта.  
Затем при вводе из файла программа может читать это целое число и применять  
`switc` для создания объекта соответствующего типа для приёма данных:  
```cpp
  // В заголовке класса
  enum classkind {Employee, Manager, Fink, Highfink};
  ...
  int classtype;
  // Символ новой строки отделяет целое число от данных
  while ((fin >> classtype).get(ch)) {
    switch (classtype) {
      case Employee : pc[i] = new employee;
                      break;
    }
  }
```
Затем можно использовать указатель, чтобы вызвать виртуальную функцию `getall()`  
для считывания информации:
```cpp
  pc[i++]->getall();
```

